# ==============================================================================
# Zero Sum Nutrition — Environment Variables
# ==============================================================================
# Copy this file to .env.local (for apps/web) or .env (for workers)
# and fill in the values for your environment.
#
# DEPLOYMENT MATRIX:
# ┌──────────────────────────────────────┬──────────┬─────────┐
# │ Variable                             │ Vercel   │ Railway │
# ├──────────────────────────────────────┼──────────┼─────────┤
# │ DATABASE_URL                         │ Yes      │ No      │
# │ CLERK_SECRET_KEY                     │ Yes      │ No      │
# │ NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY    │ Yes      │ No      │
# │ ANTHROPIC_API_KEY                    │ Yes      │ Yes     │
# │ FATSECRET_CLIENT_ID                  │ Yes      │ Yes     │
# │ FATSECRET_CLIENT_SECRET              │ Yes      │ Yes     │
# │ USDA_API_KEY                         │ Yes      │ Yes     │
# │ REDIS_URL                            │ Yes      │ Yes     │
# │ UPSTASH_REDIS_REST_URL               │ Yes      │ No      │
# │ UPSTASH_REDIS_REST_TOKEN             │ Yes      │ No      │
# │ INTERNAL_API_SECRET                  │ Yes      │ Yes     │
# │ WEB_APP_URL                          │ Yes      │ Yes     │
# │ TOKEN_ENCRYPTION_KEY                 │ Yes      │ No      │
# │ BLOB_READ_WRITE_TOKEN                │ Yes      │ No      │
# │ NODE_ENV                             │ auto     │ Set     │
# └──────────────────────────────────────┴──────────┴─────────┘
# ==============================================================================

# ==============================================================================
# Database (Neon PostgreSQL) — Vercel only
# ==============================================================================
# Get your connection string from https://console.neon.tech
DATABASE_URL=postgresql://user:password@host:5432/dbname

# Local Docker development (use with docker-compose.dev.yml)
# Uncomment these lines when running services locally with `pnpm services:up`
# DATABASE_URL=postgresql://zsn:zsn_dev@localhost:5432/zero_sum_nutrition
# REDIS_URL=redis://localhost:6379

# ==============================================================================
# Authentication (Clerk) — Vercel only
# ==============================================================================
# Get keys from https://dashboard.clerk.com
CLERK_SECRET_KEY=sk_test_...
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_...

# Clerk route configuration
NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in
NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up
NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL=/dashboard
NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL=/onboarding

# ==============================================================================
# AI (Anthropic Claude) — Vercel + Railway
# ==============================================================================
# Get your API key from https://console.anthropic.com
ANTHROPIC_API_KEY=sk-ant-...

# ==============================================================================
# Food APIs — Vercel + Railway
# ==============================================================================
# FatSecret Platform API — https://platform.fatsecret.com/api/
FATSECRET_CLIENT_ID=your_client_id
FATSECRET_CLIENT_SECRET=your_client_secret

# FatSecret proxy (optional — for production rate limit management)
# FATSECRET_PROXY_URL=
# FATSECRET_PROXY_SECRET=

# USDA FoodData Central (optional — fallback nutrition source)
# Get key from https://fdc.nal.usda.gov/api-key-signup.html
USDA_API_KEY=

# ==============================================================================
# Redis (Upstash) — Vercel + Railway
# ==============================================================================
# Get your connection URL from https://console.upstash.com
# Used for BullMQ job queue and pub/sub
REDIS_URL=rediss://default:password@host:6379

# Upstash Redis REST API (for rate limiting) — Vercel only
UPSTASH_REDIS_REST_URL=https://your-instance.upstash.io
UPSTASH_REDIS_REST_TOKEN=your_token_here

# ==============================================================================
# File Storage (Vercel Blob) — Vercel only
# ==============================================================================
# Get token from Vercel dashboard -> Storage -> Blob
BLOB_READ_WRITE_TOKEN=vercel_blob_rw_...

# ==============================================================================
# Security / Encryption
# ==============================================================================

# Token Encryption Key (required for fitness OAuth token encryption) — Vercel only
# Generate with: openssl rand -hex 32
# IMPORTANT: This key must be 64 hex characters (32 bytes)
TOKEN_ENCRYPTION_KEY=your_64_char_hex_key_here

# Internal API secret for worker -> web app communication — Vercel + Railway
# MUST be at least 20 characters in production
# Generate with: openssl rand -base64 32
INTERNAL_API_SECRET=your_random_secret_min_20_chars

# ==============================================================================
# Application URLs
# ==============================================================================

# Web app URL (used by the queue worker to call back to the web app)
# - Development: http://localhost:3456
# - Production (Vercel): https://your-app.vercel.app (set to your production URL)
# - Railway worker: Set to the Vercel production URL
WEB_APP_URL=http://localhost:3456

# Public app URL for meta tags (optional)
# NEXT_PUBLIC_APP_URL=https://your-app.vercel.app

# ==============================================================================
# Development Options
# ==============================================================================

# Use in-memory mock queue instead of real Redis/BullMQ (for local dev without Redis)
USE_MOCK_QUEUE=true

# ==============================================================================
# Fitness Integrations (Optional) — Vercel only
# ==============================================================================
# FITBIT_CLIENT_ID=
# FITBIT_CLIENT_SECRET=
# OURA_CLIENT_ID=
# OURA_CLIENT_SECRET=
# GOOGLE_FIT_CLIENT_ID=
# GOOGLE_FIT_CLIENT_SECRET=
